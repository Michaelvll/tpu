WARNING:tensorflow:From /home/ubuntu/anaconda3/envs/tensorflow2_latest_p37/gpu_cuda11.0/lib/python3.7/site-packages/tensorflow/python/compat/v2_compat.py:96: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
W0803 10:06:59.058344 140214897387328 flags_to_params.py:44] Flag tpu is None.
INFO:tensorflow:Params:
{'augment_name': None,
 'base_learning_rate': 0.1,
 'bn_momentum': 0.9,
 'data_dir': '/data/tfrecords',
 'data_format': 'channels_last',
 'drop_connect_rate': None,
 'dropblock_groups': '',
 'dropblock_keep_prob': None,
 'dropblock_size': 7,
 'dropout_rate': None,
 'enable_lars': False,
 'eval_batch_size': 1024,
 'image_size': 224,
 'iterations_per_loop': 1251,
 'label_smoothing': 0.0,
 'model_dir': './model',
 'momentum': 0.9,
 'moving_average_decay': 0,
 'norm_act_layer': 'bn_relu',
 'num_cores': 8,
 'num_eval_images': 50000,
 'num_label_classes': 1000,
 'num_parallel_calls': 8,
 'num_train_images': 1281167,
 'poly_rate': 0.0,
 'pre_activation': False,
 'precision': 'float32',
 'randaug_magnitude': None,
 'randaug_num_layers': None,
 'replace_stem_max_pool': False,
 'resnet_depth': 50,
 'resnetd_shortcut': False,
 'se_ratio': None,
 'skip_host_call': False,
 'train_batch_size': 128,
 'train_steps': 4096,
 'transpose_input': True,
 'use_async_checkpointing': False,
 'use_cache': True,
 'use_resnetd_stem': False,
 'use_tpu': False,
 'weight_decay': 0.0001}
I0803 10:06:59.059037 140214897387328 resnet_main.py:716] Params:
{'augment_name': None,
 'base_learning_rate': 0.1,
 'bn_momentum': 0.9,
 'data_dir': '/data/tfrecords',
 'data_format': 'channels_last',
 'drop_connect_rate': None,
 'dropblock_groups': '',
 'dropblock_keep_prob': None,
 'dropblock_size': 7,
 'dropout_rate': None,
 'enable_lars': False,
 'eval_batch_size': 1024,
 'image_size': 224,
 'iterations_per_loop': 1251,
 'label_smoothing': 0.0,
 'model_dir': './model',
 'momentum': 0.9,
 'moving_average_decay': 0,
 'norm_act_layer': 'bn_relu',
 'num_cores': 8,
 'num_eval_images': 50000,
 'num_label_classes': 1000,
 'num_parallel_calls': 8,
 'num_train_images': 1281167,
 'poly_rate': 0.0,
 'pre_activation': False,
 'precision': 'float32',
 'randaug_magnitude': None,
 'randaug_num_layers': None,
 'replace_stem_max_pool': False,
 'resnet_depth': 50,
 'resnetd_shortcut': False,
 'se_ratio': None,
 'skip_host_call': False,
 'train_batch_size': 128,
 'train_steps': 4096,
 'transpose_input': True,
 'use_async_checkpointing': False,
 'use_cache': True,
 'use_resnetd_stem': False,
 'use_tpu': False,
 'weight_decay': 0.0001}
WARNING:tensorflow:From official/resnet/resnet_main.py:728: The name tf.estimator.tpu.RunConfig is deprecated. Please use tf.compat.v1.estimator.tpu.RunConfig instead.

W0803 10:06:59.918581 140214897387328 module_wrapper.py:138] From official/resnet/resnet_main.py:728: The name tf.estimator.tpu.RunConfig is deprecated. Please use tf.compat.v1.estimator.tpu.RunConfig instead.

INFO:tensorflow:Using MirroredStrategy with devices ('/device:GPU:0', '/device:GPU:1', '/device:GPU:2', '/device:GPU:3', '/device:GPU:4', '/device:GPU:5', '/device:GPU:6', '/device:GPU:7')
I0803 10:07:04.749025 140214897387328 mirrored_strategy.py:350] Using MirroredStrategy with devices ('/device:GPU:0', '/device:GPU:1', '/device:GPU:2', '/device:GPU:3', '/device:GPU:4', '/device:GPU:5', '/device:GPU:6', '/device:GPU:7')
INFO:tensorflow:Single-worker MultiWorkerMirroredStrategy with local_devices = ('/device:GPU:0', '/device:GPU:1', '/device:GPU:2', '/device:GPU:3', '/device:GPU:4', '/device:GPU:5', '/device:GPU:6', '/device:GPU:7'), communication = CommunicationImplementation.AUTO
I0803 10:07:04.749967 140214897387328 collective_all_reduce_strategy.py:404] Single-worker MultiWorkerMirroredStrategy with local_devices = ('/device:GPU:0', '/device:GPU:1', '/device:GPU:2', '/device:GPU:3', '/device:GPU:4', '/device:GPU:5', '/device:GPU:6', '/device:GPU:7'), communication = CommunicationImplementation.AUTO
INFO:tensorflow:Using MirroredStrategy with devices ('/device:GPU:0', '/device:GPU:1', '/device:GPU:2', '/device:GPU:3', '/device:GPU:4', '/device:GPU:5', '/device:GPU:6', '/device:GPU:7')
I0803 10:07:04.751258 140214897387328 mirrored_strategy.py:350] Using MirroredStrategy with devices ('/device:GPU:0', '/device:GPU:1', '/device:GPU:2', '/device:GPU:3', '/device:GPU:4', '/device:GPU:5', '/device:GPU:6', '/device:GPU:7')
INFO:tensorflow:Single-worker MultiWorkerMirroredStrategy with local_devices = ('/device:GPU:0', '/device:GPU:1', '/device:GPU:2', '/device:GPU:3', '/device:GPU:4', '/device:GPU:5', '/device:GPU:6', '/device:GPU:7'), communication = CommunicationImplementation.AUTO
I0803 10:07:04.751380 140214897387328 collective_all_reduce_strategy.py:404] Single-worker MultiWorkerMirroredStrategy with local_devices = ('/device:GPU:0', '/device:GPU:1', '/device:GPU:2', '/device:GPU:3', '/device:GPU:4', '/device:GPU:5', '/device:GPU:6', '/device:GPU:7'), communication = CommunicationImplementation.AUTO
WARNING:tensorflow:From official/resnet/resnet_main.py:737: The name tf.estimator.tpu.TPUConfig is deprecated. Please use tf.compat.v1.estimator.tpu.TPUConfig instead.

W0803 10:07:04.751748 140214897387328 module_wrapper.py:138] From official/resnet/resnet_main.py:737: The name tf.estimator.tpu.TPUConfig is deprecated. Please use tf.compat.v1.estimator.tpu.TPUConfig instead.

WARNING:tensorflow:From official/resnet/resnet_main.py:740: The name tf.estimator.tpu.InputPipelineConfig is deprecated. Please use tf.compat.v1.estimator.tpu.InputPipelineConfig instead.

W0803 10:07:04.751852 140214897387328 module_wrapper.py:138] From official/resnet/resnet_main.py:740: The name tf.estimator.tpu.InputPipelineConfig is deprecated. Please use tf.compat.v1.estimator.tpu.InputPipelineConfig instead.

INFO:tensorflow:Initializing RunConfig with distribution strategies.
I0803 10:07:04.752192 140214897387328 run_config.py:584] Initializing RunConfig with distribution strategies.
INFO:tensorflow:Not using Distribute Coordinator.
I0803 10:07:04.752317 140214897387328 estimator_training.py:167] Not using Distribute Coordinator.
WARNING:tensorflow:From official/resnet/resnet_main.py:743: The name tf.estimator.tpu.TPUEstimator is deprecated. Please use tf.compat.v1.estimator.tpu.TPUEstimator instead.

W0803 10:07:04.752419 140214897387328 module_wrapper.py:138] From official/resnet/resnet_main.py:743: The name tf.estimator.tpu.TPUEstimator is deprecated. Please use tf.compat.v1.estimator.tpu.TPUEstimator instead.

INFO:tensorflow:Using config: {'_model_dir': './model', '_tf_random_seed': None, '_save_summary_steps': 100, '_save_checkpoints_steps': 5000, '_save_checkpoints_secs': None, '_session_config': graph_options {
  rewrite_options {
    disable_meta_optimizer: true
  }
}
, '_keep_checkpoint_max': 5, '_keep_checkpoint_every_n_hours': 10000, '_log_step_count_steps': None, '_train_distribute': <tensorflow.python.distribute.collective_all_reduce_strategy.CollectiveAllReduceStrategyV1 object at 0x7f8628c41a90>, '_device_fn': None, '_protocol': None, '_eval_distribute': <tensorflow.python.distribute.collective_all_reduce_strategy.CollectiveAllReduceStrategyV1 object at 0x7f8628c41b10>, '_experimental_distribute': None, '_experimental_max_worker_delay_secs': None, '_session_creation_timeout_secs': 7200, '_checkpoint_save_graph_def': True, '_service': None, '_cluster_spec': ClusterSpec({}), '_task_type': 'worker', '_task_id': 0, '_global_id_in_cluster': 0, '_master': '', '_evaluation_master': '', '_is_chief': True, '_num_ps_replicas': 0, '_num_worker_replicas': 1, '_distribute_coordinator_mode': None, '_tpu_config': TPUConfig(iterations_per_loop=1251, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=3, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None, eval_training_input_configuration=2, experimental_host_call_every_n_steps=1, experimental_allow_per_host_v2_parallel_get_next=False, experimental_feed_hook=None), '_cluster': None}
I0803 10:07:04.755181 140214897387328 estimator.py:192] Using config: {'_model_dir': './model', '_tf_random_seed': None, '_save_summary_steps': 100, '_save_checkpoints_steps': 5000, '_save_checkpoints_secs': None, '_session_config': graph_options {
  rewrite_options {
    disable_meta_optimizer: true
  }
}
, '_keep_checkpoint_max': 5, '_keep_checkpoint_every_n_hours': 10000, '_log_step_count_steps': None, '_train_distribute': <tensorflow.python.distribute.collective_all_reduce_strategy.CollectiveAllReduceStrategyV1 object at 0x7f8628c41a90>, '_device_fn': None, '_protocol': None, '_eval_distribute': <tensorflow.python.distribute.collective_all_reduce_strategy.CollectiveAllReduceStrategyV1 object at 0x7f8628c41b10>, '_experimental_distribute': None, '_experimental_max_worker_delay_secs': None, '_session_creation_timeout_secs': 7200, '_checkpoint_save_graph_def': True, '_service': None, '_cluster_spec': ClusterSpec({}), '_task_type': 'worker', '_task_id': 0, '_global_id_in_cluster': 0, '_master': '', '_evaluation_master': '', '_is_chief': True, '_num_ps_replicas': 0, '_num_worker_replicas': 1, '_distribute_coordinator_mode': None, '_tpu_config': TPUConfig(iterations_per_loop=1251, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=3, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None, eval_training_input_configuration=2, experimental_host_call_every_n_steps=1, experimental_allow_per_host_v2_parallel_get_next=False, experimental_feed_hook=None), '_cluster': None}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0803 10:07:04.755454 140214897387328 tpu_context.py:271] _TPUContext: eval_on_tpu True
WARNING:tensorflow:eval_on_tpu ignored because use_tpu is False.
W0803 10:07:04.755591 140214897387328 tpu_context.py:273] eval_on_tpu ignored because use_tpu is False.
INFO:tensorflow:Precision: float32
I0803 10:07:04.755653 140214897387328 resnet_main.py:756] Precision: float32
INFO:tensorflow:Using dataset: /data/tfrecords
I0803 10:07:04.755709 140214897387328 resnet_main.py:780] Using dataset: /data/tfrecords
INFO:tensorflow:Training for 4096 steps (0.41 epochs in total). Current step 0.
I0803 10:07:04.756135 140214897387328 resnet_main.py:842] Training for 4096 steps (0.41 epochs in total). Current step 0.
WARNING:tensorflow:From /home/ubuntu/tpu/models/official/resnet/imagenet_input.py:356: parallel_interleave (from tensorflow.python.data.experimental.ops.interleave_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.data.Dataset.interleave(map_func, cycle_length, block_length, num_parallel_calls=tf.data.AUTOTUNE)` instead. If sloppy execution is desired, use `tf.data.Options.experimental_deterministic`.
W0803 10:07:04.772450 140214897387328 deprecation.py:339] From /home/ubuntu/tpu/models/official/resnet/imagenet_input.py:356: parallel_interleave (from tensorflow.python.data.experimental.ops.interleave_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.data.Dataset.interleave(map_func, cycle_length, block_length, num_parallel_calls=tf.data.AUTOTUNE)` instead. If sloppy execution is desired, use `tf.data.Options.experimental_deterministic`.
WARNING:tensorflow:From /home/ubuntu/tpu/models/official/resnet/imagenet_input.py:360: shuffle_and_repeat (from tensorflow.python.data.experimental.ops.shuffle_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.data.Dataset.shuffle(buffer_size, seed)` followed by `tf.data.Dataset.repeat(count)`. Static tf.data optimizations will take care of using the fused implementation.
W0803 10:07:04.818538 140214897387328 deprecation.py:339] From /home/ubuntu/tpu/models/official/resnet/imagenet_input.py:360: shuffle_and_repeat (from tensorflow.python.data.experimental.ops.shuffle_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.data.Dataset.shuffle(buffer_size, seed)` followed by `tf.data.Dataset.repeat(count)`. Static tf.data optimizations will take care of using the fused implementation.
WARNING:tensorflow:From /home/ubuntu/tpu/models/official/resnet/imagenet_input.py:206: map_and_batch (from tensorflow.python.data.experimental.ops.batching) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.data.Dataset.map(map_func, num_parallel_calls)` followed by `tf.data.Dataset.batch(batch_size, drop_remainder)`. Static tf.data optimizations will take care of using the fused implementation.
W0803 10:07:04.820030 140214897387328 deprecation.py:339] From /home/ubuntu/tpu/models/official/resnet/imagenet_input.py:206: map_and_batch (from tensorflow.python.data.experimental.ops.batching) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.data.Dataset.map(map_func, num_parallel_calls)` followed by `tf.data.Dataset.batch(batch_size, drop_remainder)`. Static tf.data optimizations will take care of using the fused implementation.
WARNING:tensorflow:From /home/ubuntu/anaconda3/envs/tensorflow2_latest_p37/gpu_cuda11.0/lib/python3.7/site-packages/tensorflow/python/util/dispatch.py:201: sample_distorted_bounding_box (from tensorflow.python.ops.image_ops_impl) is deprecated and will be removed in a future version.
Instructions for updating:
`seed2` arg is deprecated.Use sample_distorted_bounding_box_v2 instead.
W0803 10:07:05.227103 140214897387328 deprecation.py:339] From /home/ubuntu/anaconda3/envs/tensorflow2_latest_p37/gpu_cuda11.0/lib/python3.7/site-packages/tensorflow/python/util/dispatch.py:201: sample_distorted_bounding_box (from tensorflow.python.ops.image_ops_impl) is deprecated and will be removed in a future version.
Instructions for updating:
`seed2` arg is deprecated.Use sample_distorted_bounding_box_v2 instead.
INFO:tensorflow:Calling model_fn.
I0803 10:07:05.780834 140181474629376 api.py:479] Calling model_fn.
INFO:tensorflow:Running train on CPU/GPU
I0803 10:07:07.341922 140181474629376 api.py:479] Running train on CPU/GPU
WARNING:tensorflow:From /home/ubuntu/anaconda3/envs/tensorflow2_latest_p37/gpu_cuda11.0/lib/python3.7/site-packages/tensorflow/python/autograph/converters/directives.py:130: The name tf.estimator.tpu.TPUEstimatorSpec is deprecated. Please use tf.compat.v1.estimator.tpu.TPUEstimatorSpec instead.

W0803 10:07:07.944726 140181474629376 module_wrapper.py:138] From /home/ubuntu/anaconda3/envs/tensorflow2_latest_p37/gpu_cuda11.0/lib/python3.7/site-packages/tensorflow/python/autograph/converters/directives.py:130: The name tf.estimator.tpu.TPUEstimatorSpec is deprecated. Please use tf.compat.v1.estimator.tpu.TPUEstimatorSpec instead.

